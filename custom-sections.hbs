{{!< default}}
{{#post}}
<article class="sections-article framed-article {{post_class}}" itemscope itemtype="https://schema.org/Article">
  <header class="post-header-frame hero">
    <h1 class="post-full-title" itemprop="headline">{{title}}</h1>
    <div class="post-full-meta">
      <time datetime="{{date published_at format="YYYY-MM-DD"}}" itemprop="datePublished">{{date published_at format="MMMM D, YYYY"}}</time>
      {{#if primary_tag}}<span class="latest-item-tag">{{primary_tag.name}}</span>{{/if}}
    </div>
    {{#if feature_image}}
      <figure class="post-feature-frame hero-figure">
        <img src="{{img_url feature_image size="xl"}}" alt="{{#if feature_image_alt}}{{feature_image_alt}}{{else}}{{title}}{{/if}}" loading="lazy">
      </figure>
    {{/if}}
  </header>

  <div class="post-body-frame layout">
    <aside class="toc" aria-label="Table of contents">
      <h2 class="toc-title">Sections</h2>
      <nav id="toc-list"><em>Generatingâ€¦</em></nav>
    </aside>
    <div class="post-content sections-content gh-content" itemprop="articleBody">
      {{{content}}}
    </div>
  </div>

  {{> "cta-subscribe"}}
</article>
{{/post}}

<script>
document.addEventListener('DOMContentLoaded',()=>{
  const c=document.querySelector('.sections-content');
  const t=document.getElementById('toc-list');
  if(!c||!t){return;}
  const hs=c.querySelectorAll('h2,h3');
  if(!hs.length){t.innerHTML='<em>No sections</em>';return;}
  const ol=document.createElement('ol'); ol.className='toc-list';
  hs.forEach(h=>{
    if(!h.id){
      h.id=h.textContent.trim().toLowerCase()
        .replace(/[^a-z0-9]+/g,'-').replace(/(^-|-$)/g,'');
    }
    const li=document.createElement('li');
    if(h.tagName==='H3') li.className='sub';
    const a=document.createElement('a'); a.href='#'+h.id; a.textContent=h.textContent.trim();
    li.appendChild(a); ol.appendChild(li);
  });
  t.innerHTML=''; t.appendChild(ol);
});
</script>